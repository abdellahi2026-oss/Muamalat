
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user profile in the system.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the user, matching Firebase Auth UID." },
        "name": { "type": "string", "description": "Name of the user." },
        "email": { "type": "string", "format": "email", "description": "Email address of the user." },
        "role": { "type": "string", "description": "The role of the user.", "enum": ["merchant", "admin"] },
        "status": { "type": "string", "description": "The status of the user account.", "enum": ["active", "inactive"] },
        "lastSignInTime": { "type": "string", "format": "date-time", "description": "The last time the user signed in." }
      },
      "required": ["id", "name", "email", "role", "status"]
    },
    "Client": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Client",
      "type": "object",
      "description": "Represents a client (customer) of the merchant.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the client." },
        "name": { "type": "string", "description": "Name of the client." },
        "phone": { "type": "string", "description": "Phone number of the client." },
        "totalDue": { "type": "number", "description": "Aggregated amount from all their active contracts." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the client was created." },
        "ownerId": { "type": "string", "description": "The UID of the merchant who owns this client record." }
      },
      "required": ["id", "name", "totalDue", "createdAt", "ownerId"]
    },
    "Product": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Product",
        "type": "object",
        "description": "Represents a product the merchant sells.",
        "properties": {
            "id": { "type": "string", "description": "Unique identifier for the product." },
            "name": { "type": "string", "description": "Name of the product." },
            "purchasePrice": { "type": "number", "description": "The cost price of the product." },
            "sellingPrice": { "type": "number", "description": "The selling price for deferred payment." },
            "stock": { "type": "number", "description": "The quantity available in inventory." },
            "ownerId": { "type": "string", "description": "The UID of the merchant who owns this product." }
        },
        "required": ["id", "name", "purchasePrice", "sellingPrice", "stock", "ownerId"]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a single Murabaha (deferred payment) transaction.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the transaction." },
        "clientId": { "type": "string", "description": "ID of the client." },
        "clientName": { "type": "string", "description": "Denormalized client name for quick display." },
        "productId": { "type": "string", "description": "ID of the product." },
        "productName": { "type": "string", "description": "Denormalized product name for quick display." },
        "quantity": { "type": "number" },
        "purchasePrice": { "type": "number", "description": "Purchase price per unit at time of transaction." },
        "sellingPrice": { "type": "number", "description": "Selling price per unit at time of transaction." },
        "totalAmount": { "type": "number", "description": "Total selling price for the transaction (quantity * sellingPrice)." },
        "profit": { "type": "number", "description": "Profit for the transaction." },
        "issueDate": { "type": "string", "format": "date-time" },
        "dueDate": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["active", "completed", "overdue", "archived"] },
        "paidAmount": { "type": "number", "description": "Amount paid by the client so far." },
        "remainingAmount": { "type": "number", "description": "Remaining amount to be paid." },
        "ownerId": { "type": "string", "description": "The UID of the merchant who owns this transaction." }
      },
      "required": ["id", "clientId", "clientName", "productId", "productName", "quantity", "purchasePrice", "sellingPrice", "totalAmount", "profit", "issueDate", "dueDate", "status", "paidAmount", "remainingAmount", "ownerId"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "schema": { "$ref": "#/entities/User" },
          "description": "Stores user profile information. User's auth UID is used as the document ID."
        }
      },
      {
        "path": "/users/{userId}/clients/{clientId}",
        "definition": {
          "schema": { "$ref": "#/entities/Client" },
          "description": "Stores client information for a specific merchant."
        }
      },
       {
        "path": "/users/{userId}/products/{productId}",
        "definition": {
          "schema": { "$ref": "#/entities/Product" },
          "description": "Stores product and inventory information for a specific merchant."
        }
      },
      {
        "path": "/users/{userId}/transactions/{transactionId}",
        "definition": {
          "schema": { "$ref": "#/entities/Transaction" },
          "description": "Stores all transactions for a specific merchant."
        }
      }
    ]
  }
}
